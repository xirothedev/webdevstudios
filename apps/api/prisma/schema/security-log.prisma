// Copyright (c) 2026 Xiro The Dev <lethanhtrung.trungle@gmail.com>
//
// Source Available License
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to:
// - View and study the Software for educational purposes
// - Fork this repository on GitHub for personal reference
// - Share links to this repository
//
// THE FOLLOWING ARE PROHIBITED:
// - Using the Software in production or commercial applications
// - Copying substantial portions of the Software into other projects
// - Distributing modified versions of the Software
// - Removing or altering copyright notices
//
// For commercial licensing or usage permissions, contact: lethanhtrung.trungle@gmail.com
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND.
//
model SecurityLog {
  id        String   @id @default(cuid())
  type      String // SecurityEventType enum
  severity  String // low, medium, high, critical
  message   String   @db.Text
  userId    String?
  ipAddress String?
  userAgent String?
  path      String?
  method    String?
  metadata  Json?
  timestamp DateTime @default(now())

  // Indexes for efficient querying
  @@index([type])
  @@index([severity])
  @@index([timestamp])
  @@index([userId])
  @@index([ipAddress])
  @@map("security_logs")
}
