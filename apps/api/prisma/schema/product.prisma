// =========================================
// PRODUCT MANAGEMENT (Simplified for 4 fixed products)
// =========================================


model Product {
  id          String      @id @default(cuid())
  slug        ProductSlug @unique // Enum đảm bảo chỉ có 4 sản phẩm
  name        String      @db.VarChar(255)
  description String      @db.Text

  // Giá sản phẩm
  priceCurrent  Decimal @db.Money // Giá hiện tại
  priceOriginal Decimal? @db.Money // Giá gốc (nếu có giảm giá)
  priceDiscount Decimal? @db.Money // Số tiền giảm

  // Thông tin sản phẩm
  stock       Int     @default(0) // Tổng số lượng tồn kho
  hasSizes    Boolean @default(false) // Có hỗ trợ chọn size không (chỉ áo thun)
  badge       String? @db.VarChar(50) // Badge hiển thị (Limited Edition, Official Merch)

  // Đánh giá sản phẩm
  ratingValue Decimal @default(0) @db.Decimal(3, 2) // Điểm đánh giá (0-5)
  ratingCount  Int     @default(0) // Số lượng đánh giá

  // Metadata
  isPublished Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  sizeStocks ProductSizeStock[] // Quản lý stock theo size (chỉ áo thun)
  cartItems  CartItem[]
  orderItems OrderItem[]
  reviews    Review[]

  @@index([slug])
  @@map("products")
}

/**
 * Quản lý tồn kho theo size (chỉ cho áo thun)
 * Nếu sản phẩm không có size, stock được lưu trực tiếp ở Product.stock
 */
model ProductSizeStock {
  id     String      @id @default(cuid())
  size   ProductSize // S, M, L, XL
  stock  Int         @default(0)

  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, size]) // Mỗi size của 1 sản phẩm chỉ có 1 record
  @@index([productId])
  @@map("product_size_stocks")
}

